<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.0"/>
    <title>pangolin.ir API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pangolin.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pangolin</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="ir/op.html">op</a></li>
                    <li><a href="ir/rv.html">rv</a></li>
                    <li><a href="ir/constant.html">constant</a></li>
                    <li><a href="ir/scalar_ops.html">scalar_ops</a></li>
                    <li><a href="ir/multivariate_dists.html">multivariate_dists</a></li>
                    <li><a href="ir/multivariate_funs.html">multivariate_funs</a></li>
                    <li><a href="ir/index.html">index</a></li>
                    <li><a href="ir/vmap.html">vmap</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Op">Op</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Op.__init__">Op</a>
                        </li>
                        <li>
                                <a class="variable" href="#Op.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Op.random">random</a>
                        </li>
                        <li>
                                <a class="function" href="#Op.get_shape">get_shape</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RV">RV</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RV.__init__">RV</a>
                        </li>
                        <li>
                                <a class="variable" href="#RV.op">op</a>
                        </li>
                        <li>
                                <a class="variable" href="#RV.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#RV.ndim">ndim</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Constant">Constant</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Constant.__init__">Constant</a>
                        </li>
                        <li>
                                <a class="variable" href="#Constant.value">value</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VMap">VMap</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VMap.__init__">VMap</a>
                        </li>
                        <li>
                                <a class="variable" href="#VMap.base_op">base_op</a>
                        </li>
                        <li>
                                <a class="variable" href="#VMap.in_axes">in_axes</a>
                        </li>
                        <li>
                                <a class="variable" href="#VMap.axis_size">axis_size</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#Add">Add</a>
            </li>
            <li>
                    <a class="class" href="#Index">Index</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Index.__init__">Index</a>
                        </li>
                        <li>
                                <a class="variable" href="#Index.slices">slices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Index.advanced_at_start">advanced_at_start</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Composite">Composite</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Composite.__init__">Composite</a>
                        </li>
                        <li>
                                <a class="variable" href="#Composite.num_inputs">num_inputs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Composite.ops">ops</a>
                        </li>
                        <li>
                                <a class="variable" href="#Composite.par_nums">par_nums</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Autoregressive">Autoregressive</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Autoregressive.__init__">Autoregressive</a>
                        </li>
                        <li>
                                <a class="variable" href="#Autoregressive.base_op">base_op</a>
                        </li>
                        <li>
                                <a class="variable" href="#Autoregressive.length">length</a>
                        </li>
                        <li>
                                <a class="variable" href="#Autoregressive.in_axes">in_axes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Autoregressive.where_self">where_self</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../pangolin.html">pangolin</a><wbr>.ir    </h1>

                        <div class="docstring"><p>The core IR of pangolin is essentially just <code><a href="#Op">Op</a></code>s and <code><a href="#RV">RV</a></code>s. Intuitively,</p>

<ul>
<li>An <code><a href="#Op">Op</a></code> is a "marker" for a certain function or conditional distribution.</li>
<li>An <code><a href="#RV">RV</a></code> is a tuple of one <code><a href="#Op">Op</a></code> and some number of parent <code><a href="#RV">RV</a></code>s.</li>
</ul>

<p>There are different classes of <code><a href="#Op">Op</a></code>s, for different types of functions. For example, <code><a href="#Constant">Constant</a></code>
represents constant functions, and most standard scalar functions are in
<code><a href="ir/scalar_ops.html">pangolin.ir.scalar_ops</a></code>.</p>

<p>While not explicitly listed below, all the scalar ops in <code><a href="ir/scalar_ops.html">pangolin.ir.scalar_ops</a></code> are also
available here.</p>
</div>

                        <input id="mod-ir-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-ir-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">The core IR of pangolin is essentially just `Op`s and `RV`s. Intuitively,</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">* An `Op` is a &quot;marker&quot; for a certain function or conditional distribution.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">* An `RV` is a tuple of one `Op` and some number of parent `RV`s.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">There are different classes of `Op`s, for different types of functions. For example, `Constant`</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">represents constant functions, and most standard scalar functions are in</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">`pangolin.ir.scalar_ops`.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">While not explicitly listed below, all the scalar ops in `pangolin.ir.scalar_ops` are also</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">available here.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.op</span> <span class="kn">import</span> <span class="n">Op</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.rv</span> <span class="kn">import</span> <span class="n">RV</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.constant</span> <span class="kn">import</span> <span class="n">Constant</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.scalar_ops</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.multivariate_dists</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.multivariate_funs</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.index</span> <span class="kn">import</span> <span class="n">Index</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.vmap</span> <span class="kn">import</span> <span class="n">VMap</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.composite</span> <span class="kn">import</span> <span class="n">Composite</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="kn">from</span> <span class="nn">pangolin.ir.autoregressive</span> <span class="kn">import</span> <span class="n">Autoregressive</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Op&#39;</span><span class="p">,</span> <span class="s1">&#39;RV&#39;</span><span class="p">,</span> <span class="s1">&#39;Constant&#39;</span><span class="p">,</span> <span class="s1">&#39;op&#39;</span><span class="p">,</span> <span class="s1">&#39;rv&#39;</span><span class="p">,</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;scalar_ops&#39;</span><span class="p">,</span> <span class="s1">&#39;multivariate_dists&#39;</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>           <span class="s1">&#39;multivariate_funs&#39;</span><span class="p">,</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="s1">&#39;VMap&#39;</span><span class="p">,</span><span class="s1">&#39;vmap&#39;</span><span class="p">,</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span><span class="s1">&#39;Index&#39;</span><span class="p">,</span><span class="s1">&#39;Composite&#39;</span><span class="p">,</span><span class="s1">&#39;Autoregressive&#39;</span><span class="p">]</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="c1"># force everything to be documented</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="c1"># __all__ = [&#39;Op&#39;,&#39;RV&#39;,&#39;Constant&#39;] + [s for s in dir() if not s.startswith(&#39;_&#39;)]</span>
</span></pre></div>


            </section>
                <section id="Op">
                            <input id="Op-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Op</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="Op-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Op"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Op-8"><a href="#Op-8"><span class="linenos"> 8</span></a><span class="k">class</span> <span class="nc">Op</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="Op-9"><a href="#Op-9"><span class="linenos"> 9</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Op-10"><a href="#Op-10"><span class="linenos">10</span></a><span class="sd">    Abstract base class for operators. An `Op` represents a deterministic function or conditional</span>
</span><span id="Op-11"><a href="#Op-11"><span class="linenos">11</span></a><span class="sd">    distribution.</span>
</span><span id="Op-12"><a href="#Op-12"><span class="linenos">12</span></a>
</span><span id="Op-13"><a href="#Op-13"><span class="linenos">13</span></a><span class="sd">    Notes:</span>
</span><span id="Op-14"><a href="#Op-14"><span class="linenos">14</span></a><span class="sd">    * An `Op` *only* represents an operator—all functionality for sampling or density evaluation,</span>
</span><span id="Op-15"><a href="#Op-15"><span class="linenos">15</span></a><span class="sd">    etc. is left to inference engines.</span>
</span><span id="Op-16"><a href="#Op-16"><span class="linenos">16</span></a><span class="sd">    * `Op`s must provide an `__eq__` method such that *mathematically equivalent* `Op`s are</span>
</span><span id="Op-17"><a href="#Op-17"><span class="linenos">17</span></a><span class="sd">    equal, regardless of if they occupy the same place in memory. For example, `d1 = Normal()`</span>
</span><span id="Op-18"><a href="#Op-18"><span class="linenos">18</span></a><span class="sd">    and `d2 = Normal()` then `d1 == d2`. This base class provides a default implementation that</span>
</span><span id="Op-19"><a href="#Op-19"><span class="linenos">19</span></a><span class="sd">    simply tests if the types are the same. If an Op takes parameters (e.g. `VMap`), this should be</span>
</span><span id="Op-20"><a href="#Op-20"><span class="linenos">20</span></a><span class="sd">    overridden.</span>
</span><span id="Op-21"><a href="#Op-21"><span class="linenos">21</span></a><span class="sd">    * `Op`s are programmatically enforced to be frozen after initialization.</span>
</span><span id="Op-22"><a href="#Op-22"><span class="linenos">22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Op-23"><a href="#Op-23"><span class="linenos">23</span></a>
</span><span id="Op-24"><a href="#Op-24"><span class="linenos">24</span></a>    <span class="n">_frozen</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Op-25"><a href="#Op-25"><span class="linenos">25</span></a>
</span><span id="Op-26"><a href="#Op-26"><span class="linenos">26</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Op-27"><a href="#Op-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">random</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="Op-28"><a href="#Op-28"><span class="linenos">28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Op-29"><a href="#Op-29"><span class="linenos">29</span></a><span class="sd">        Create a new op</span>
</span><span id="Op-30"><a href="#Op-30"><span class="linenos">30</span></a><span class="sd">        Parameters</span>
</span><span id="Op-31"><a href="#Op-31"><span class="linenos">31</span></a><span class="sd">        ----------</span>
</span><span id="Op-32"><a href="#Op-32"><span class="linenos">32</span></a><span class="sd">        name: str</span>
</span><span id="Op-33"><a href="#Op-33"><span class="linenos">33</span></a><span class="sd">            name for the operator (used only for printing, not functionality)</span>
</span><span id="Op-34"><a href="#Op-34"><span class="linenos">34</span></a><span class="sd">        random: bool</span>
</span><span id="Op-35"><a href="#Op-35"><span class="linenos">35</span></a><span class="sd">            is this a conditional distribution? (`random=True`) or a deterministic function (</span>
</span><span id="Op-36"><a href="#Op-36"><span class="linenos">36</span></a><span class="sd">            `random=False`)?</span>
</span><span id="Op-37"><a href="#Op-37"><span class="linenos">37</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Op-38"><a href="#Op-38"><span class="linenos">38</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="Op-39"><a href="#Op-39"><span class="linenos">39</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
</span><span id="Op-40"><a href="#Op-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Op-41"><a href="#Op-41"><span class="linenos">41</span></a>        <span class="s2">&quot;The name of the Op&quot;</span>
</span><span id="Op-42"><a href="#Op-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">random</span>
</span><span id="Op-43"><a href="#Op-43"><span class="linenos">43</span></a>        <span class="s2">&quot;True for conditional distributions, False for deterministic functions&quot;</span>
</span><span id="Op-44"><a href="#Op-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frozen</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># freeze after init</span>
</span><span id="Op-45"><a href="#Op-45"><span class="linenos">45</span></a>
</span><span id="Op-46"><a href="#Op-46"><span class="linenos">46</span></a>    <span class="k">def</span> <span class="nf">get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parents_shapes</span><span class="p">):</span>
</span><span id="Op-47"><a href="#Op-47"><span class="linenos">47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Op-48"><a href="#Op-48"><span class="linenos">48</span></a><span class="sd">        Given the shapes of parents, return the shape of the output of this `Op`. Subclasses</span>
</span><span id="Op-49"><a href="#Op-49"><span class="linenos">49</span></a><span class="sd">        must provide a `_get_shape(*parents_shapes)` function. This is needed because some `Op`s</span>
</span><span id="Op-50"><a href="#Op-50"><span class="linenos">50</span></a><span class="sd">        (e.g. multivariate normal distributions) can have different shapes depending on the</span>
</span><span id="Op-51"><a href="#Op-51"><span class="linenos">51</span></a><span class="sd">        shapes of the parents.</span>
</span><span id="Op-52"><a href="#Op-52"><span class="linenos">52</span></a>
</span><span id="Op-53"><a href="#Op-53"><span class="linenos">53</span></a><span class="sd">        It is also expected that `Op`s define a `_get_shape` method that does error checking—e.g.</span>
</span><span id="Op-54"><a href="#Op-54"><span class="linenos">54</span></a><span class="sd">        verifies that the correct number of arguments are provided and the shapes of the parents</span>
</span><span id="Op-55"><a href="#Op-55"><span class="linenos">55</span></a><span class="sd">        are coherent with each other.</span>
</span><span id="Op-56"><a href="#Op-56"><span class="linenos">56</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Op-57"><a href="#Op-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">parents_shapes</span><span class="p">)</span>
</span><span id="Op-58"><a href="#Op-58"><span class="linenos">58</span></a>
</span><span id="Op-59"><a href="#Op-59"><span class="linenos">59</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Op-60"><a href="#Op-60"><span class="linenos">60</span></a>    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parents_shapes</span><span class="p">):</span>
</span><span id="Op-61"><a href="#Op-61"><span class="linenos">61</span></a>        <span class="k">pass</span>
</span><span id="Op-62"><a href="#Op-62"><span class="linenos">62</span></a>
</span><span id="Op-63"><a href="#Op-63"><span class="linenos">63</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Op-64"><a href="#Op-64"><span class="linenos">64</span></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Op-65"><a href="#Op-65"><span class="linenos">65</span></a>
</span><span id="Op-66"><a href="#Op-66"><span class="linenos">66</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Op-67"><a href="#Op-67"><span class="linenos">67</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="Op-68"><a href="#Op-68"><span class="linenos">68</span></a>
</span><span id="Op-69"><a href="#Op-69"><span class="linenos">69</span></a>    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="Op-70"><a href="#Op-70"><span class="linenos">70</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frozen</span><span class="p">:</span>
</span><span id="Op-71"><a href="#Op-71"><span class="linenos">71</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;CondDists are immutable after init.&quot;</span><span class="p">)</span>
</span><span id="Op-72"><a href="#Op-72"><span class="linenos">72</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Op-73"><a href="#Op-73"><span class="linenos">73</span></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Op-74"><a href="#Op-74"><span class="linenos">74</span></a>
</span><span id="Op-75"><a href="#Op-75"><span class="linenos">75</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Op-76"><a href="#Op-76"><span class="linenos">76</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;()&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class for operators. An <code><a href="#Op">Op</a></code> represents a deterministic function or conditional
distribution.</p>

<p>Notes:</p>

<ul>
<li>An <code><a href="#Op">Op</a></code> <em>only</em> represents an operator—all functionality for sampling or density evaluation,
etc. is left to inference engines.</li>
<li><code><a href="#Op">Op</a></code>s must provide an <code>__eq__</code> method such that <em>mathematically equivalent</em> <code><a href="#Op">Op</a></code>s are
equal, regardless of if they occupy the same place in memory. For example, <code>d1 = Normal()</code>
and <code>d2 = Normal()</code> then <code>d1 == d2</code>. This base class provides a default implementation that
simply tests if the types are the same. If an Op takes parameters (e.g. <code><a href="#VMap">VMap</a></code>), this should be
overridden.</li>
<li><code><a href="#Op">Op</a></code>s are programmatically enforced to be frozen after initialization.</li>
</ul>
</div>


                            <div id="Op.__init__" class="classattr">
                                        <input id="Op.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Op</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">random</span><span class="p">:</span> <span class="nb">bool</span></span>)</span>

                <label class="view-source-button" for="Op.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Op.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Op.__init__-26"><a href="#Op.__init__-26"><span class="linenos">26</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Op.__init__-27"><a href="#Op.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">random</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="Op.__init__-28"><a href="#Op.__init__-28"><span class="linenos">28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Op.__init__-29"><a href="#Op.__init__-29"><span class="linenos">29</span></a><span class="sd">        Create a new op</span>
</span><span id="Op.__init__-30"><a href="#Op.__init__-30"><span class="linenos">30</span></a><span class="sd">        Parameters</span>
</span><span id="Op.__init__-31"><a href="#Op.__init__-31"><span class="linenos">31</span></a><span class="sd">        ----------</span>
</span><span id="Op.__init__-32"><a href="#Op.__init__-32"><span class="linenos">32</span></a><span class="sd">        name: str</span>
</span><span id="Op.__init__-33"><a href="#Op.__init__-33"><span class="linenos">33</span></a><span class="sd">            name for the operator (used only for printing, not functionality)</span>
</span><span id="Op.__init__-34"><a href="#Op.__init__-34"><span class="linenos">34</span></a><span class="sd">        random: bool</span>
</span><span id="Op.__init__-35"><a href="#Op.__init__-35"><span class="linenos">35</span></a><span class="sd">            is this a conditional distribution? (`random=True`) or a deterministic function (</span>
</span><span id="Op.__init__-36"><a href="#Op.__init__-36"><span class="linenos">36</span></a><span class="sd">            `random=False`)?</span>
</span><span id="Op.__init__-37"><a href="#Op.__init__-37"><span class="linenos">37</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Op.__init__-38"><a href="#Op.__init__-38"><span class="linenos">38</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="Op.__init__-39"><a href="#Op.__init__-39"><span class="linenos">39</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
</span><span id="Op.__init__-40"><a href="#Op.__init__-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Op.__init__-41"><a href="#Op.__init__-41"><span class="linenos">41</span></a>        <span class="s2">&quot;The name of the Op&quot;</span>
</span><span id="Op.__init__-42"><a href="#Op.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">random</span>
</span><span id="Op.__init__-43"><a href="#Op.__init__-43"><span class="linenos">43</span></a>        <span class="s2">&quot;True for conditional distributions, False for deterministic functions&quot;</span>
</span><span id="Op.__init__-44"><a href="#Op.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frozen</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># freeze after init</span>
</span></pre></div>


            <div class="docstring"><p>Create a new op</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
name for the operator (used only for printing, not functionality)</li>
<li><strong>random</strong> (bool):
is this a conditional distribution? (<code>random=True</code>) or a deterministic function (
<code>random=False</code>)?</li>
</ul>
</div>


                            </div>
                            <div id="Op.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Op.name"></a>
    
            <div class="docstring"><p>The name of the Op</p>
</div>


                            </div>
                            <div id="Op.random" class="classattr">
                                <div class="attr variable">
            <span class="name">random</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#Op.random"></a>
    
            <div class="docstring"><p>True for conditional distributions, False for deterministic functions</p>
</div>


                            </div>
                            <div id="Op.get_shape" class="classattr">
                                        <input id="Op.get_shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_shape</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">parents_shapes</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Op.get_shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Op.get_shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Op.get_shape-46"><a href="#Op.get_shape-46"><span class="linenos">46</span></a>    <span class="k">def</span> <span class="nf">get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parents_shapes</span><span class="p">):</span>
</span><span id="Op.get_shape-47"><a href="#Op.get_shape-47"><span class="linenos">47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Op.get_shape-48"><a href="#Op.get_shape-48"><span class="linenos">48</span></a><span class="sd">        Given the shapes of parents, return the shape of the output of this `Op`. Subclasses</span>
</span><span id="Op.get_shape-49"><a href="#Op.get_shape-49"><span class="linenos">49</span></a><span class="sd">        must provide a `_get_shape(*parents_shapes)` function. This is needed because some `Op`s</span>
</span><span id="Op.get_shape-50"><a href="#Op.get_shape-50"><span class="linenos">50</span></a><span class="sd">        (e.g. multivariate normal distributions) can have different shapes depending on the</span>
</span><span id="Op.get_shape-51"><a href="#Op.get_shape-51"><span class="linenos">51</span></a><span class="sd">        shapes of the parents.</span>
</span><span id="Op.get_shape-52"><a href="#Op.get_shape-52"><span class="linenos">52</span></a>
</span><span id="Op.get_shape-53"><a href="#Op.get_shape-53"><span class="linenos">53</span></a><span class="sd">        It is also expected that `Op`s define a `_get_shape` method that does error checking—e.g.</span>
</span><span id="Op.get_shape-54"><a href="#Op.get_shape-54"><span class="linenos">54</span></a><span class="sd">        verifies that the correct number of arguments are provided and the shapes of the parents</span>
</span><span id="Op.get_shape-55"><a href="#Op.get_shape-55"><span class="linenos">55</span></a><span class="sd">        are coherent with each other.</span>
</span><span id="Op.get_shape-56"><a href="#Op.get_shape-56"><span class="linenos">56</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Op.get_shape-57"><a href="#Op.get_shape-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">parents_shapes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given the shapes of parents, return the shape of the output of this <code><a href="#Op">Op</a></code>. Subclasses
must provide a <code>_get_shape(*parents_shapes)</code> function. This is needed because some <code><a href="#Op">Op</a></code>s
(e.g. multivariate normal distributions) can have different shapes depending on the
shapes of the parents.</p>

<p>It is also expected that <code><a href="#Op">Op</a></code>s define a <code>_get_shape</code> method that does error checking—e.g.
verifies that the correct number of arguments are provided and the shapes of the parents
are coherent with each other.</p>
</div>


                            </div>
                </section>
                <section id="RV">
                            <input id="RV-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RV</span><wbr>(<span class="base">pangolin.dag.Node</span>):

                <label class="view-source-button" for="RV-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RV"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RV-6"><a href="#RV-6"><span class="linenos"> 6</span></a><span class="k">class</span> <span class="nc">RV</span><span class="p">(</span><span class="n">dag</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
</span><span id="RV-7"><a href="#RV-7"><span class="linenos"> 7</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV-8"><a href="#RV-8"><span class="linenos"> 8</span></a><span class="sd">    A RV is essentially just a tuple of an Op and a set of parent RVs.</span>
</span><span id="RV-9"><a href="#RV-9"><span class="linenos"> 9</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RV-10"><a href="#RV-10"><span class="linenos">10</span></a>    <span class="n">_frozen</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="RV-11"><a href="#RV-11"><span class="linenos">11</span></a>    <span class="n">__array_priority__</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># so x @ y works when x numpy.ndarray and y RV</span>
</span><span id="RV-12"><a href="#RV-12"><span class="linenos">12</span></a>
</span><span id="RV-13"><a href="#RV-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">parents</span><span class="p">:</span> <span class="n">Self</span><span class="p">):</span>
</span><span id="RV-14"><a href="#RV-14"><span class="linenos">14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV-15"><a href="#RV-15"><span class="linenos">15</span></a><span class="sd">        Initialize an RV with Op `op` and parents `*parents`.</span>
</span><span id="RV-16"><a href="#RV-16"><span class="linenos">16</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV-17"><a href="#RV-17"><span class="linenos">17</span></a>
</span><span id="RV-18"><a href="#RV-18"><span class="linenos">18</span></a>        <span class="n">parents_shapes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">)</span>
</span><span id="RV-19"><a href="#RV-19"><span class="linenos">19</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">parents_shapes</span><span class="p">)</span>
</span><span id="RV-20"><a href="#RV-20"><span class="linenos">20</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
</span><span id="RV-21"><a href="#RV-21"><span class="linenos">21</span></a>        <span class="s2">&quot;The Op corresponding to this RV.&quot;</span>
</span><span id="RV-22"><a href="#RV-22"><span class="linenos">22</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">parents</span><span class="p">)</span>
</span><span id="RV-23"><a href="#RV-23"><span class="linenos">23</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frozen</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="RV-24"><a href="#RV-24"><span class="linenos">24</span></a>
</span><span id="RV-25"><a href="#RV-25"><span class="linenos">25</span></a>    <span class="nd">@property</span>
</span><span id="RV-26"><a href="#RV-26"><span class="linenos">26</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV-27"><a href="#RV-27"><span class="linenos">27</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV-28"><a href="#RV-28"><span class="linenos">28</span></a><span class="sd">        The shape of the RV. (A tuple of ints.)</span>
</span><span id="RV-29"><a href="#RV-29"><span class="linenos">29</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV-30"><a href="#RV-30"><span class="linenos">30</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>
</span><span id="RV-31"><a href="#RV-31"><span class="linenos">31</span></a>
</span><span id="RV-32"><a href="#RV-32"><span class="linenos">32</span></a>    <span class="nd">@property</span>
</span><span id="RV-33"><a href="#RV-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV-34"><a href="#RV-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV-35"><a href="#RV-35"><span class="linenos">35</span></a><span class="sd">        The number of dimensions of the RV. Equal to the length of `shape`.</span>
</span><span id="RV-36"><a href="#RV-36"><span class="linenos">36</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV-37"><a href="#RV-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>
</span><span id="RV-38"><a href="#RV-38"><span class="linenos">38</span></a>
</span><span id="RV-39"><a href="#RV-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV-40"><a href="#RV-40"><span class="linenos">40</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="RV-41"><a href="#RV-41"><span class="linenos">41</span></a>
</span><span id="RV-42"><a href="#RV-42"><span class="linenos">42</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV-43"><a href="#RV-43"><span class="linenos">43</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;RV(&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">)</span>
</span><span id="RV-44"><a href="#RV-44"><span class="linenos">44</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>
</span><span id="RV-45"><a href="#RV-45"><span class="linenos">45</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;, parents=[&quot;</span> <span class="o">+</span> <span class="n">util</span><span class="o">.</span><span class="n">comma_separated</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">,</span> <span class="nb">repr</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
</span><span id="RV-46"><a href="#RV-46"><span class="linenos">46</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="RV-47"><a href="#RV-47"><span class="linenos">47</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="RV-48"><a href="#RV-48"><span class="linenos">48</span></a>
</span><span id="RV-49"><a href="#RV-49"><span class="linenos">49</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV-50"><a href="#RV-50"><span class="linenos">50</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">)</span>
</span><span id="RV-51"><a href="#RV-51"><span class="linenos">51</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>
</span><span id="RV-52"><a href="#RV-52"><span class="linenos">52</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="n">util</span><span class="o">.</span><span class="n">comma_separated</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="RV-53"><a href="#RV-53"><span class="linenos">53</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="RV-54"><a href="#RV-54"><span class="linenos">54</span></a>
</span><span id="RV-55"><a href="#RV-55"><span class="linenos">55</span></a>    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="RV-56"><a href="#RV-56"><span class="linenos">56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV-57"><a href="#RV-57"><span class="linenos">57</span></a><span class="sd">        Set attribute. Special case to freeze after init.</span>
</span><span id="RV-58"><a href="#RV-58"><span class="linenos">58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV-59"><a href="#RV-59"><span class="linenos">59</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frozen</span><span class="p">:</span>
</span><span id="RV-60"><a href="#RV-60"><span class="linenos">60</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;RVs are immutable after init.&quot;</span><span class="p">)</span>
</span><span id="RV-61"><a href="#RV-61"><span class="linenos">61</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RV-62"><a href="#RV-62"><span class="linenos">62</span></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="RV-63"><a href="#RV-63"><span class="linenos">63</span></a>
</span><span id="RV-64"><a href="#RV-64"><span class="linenos">64</span></a>    <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;op&#39;</span><span class="p">,</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span><span class="s1">&#39;parents&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>A RV is essentially just a tuple of an Op and a set of parent RVs.</p>
</div>


                            <div id="RV.__init__" class="classattr">
                                        <input id="RV.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RV</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">op</span>, </span><span class="param"><span class="o">*</span><span class="n">parents</span><span class="p">:</span> <span class="n">Self</span></span>)</span>

                <label class="view-source-button" for="RV.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RV.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RV.__init__-13"><a href="#RV.__init__-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">parents</span><span class="p">:</span> <span class="n">Self</span><span class="p">):</span>
</span><span id="RV.__init__-14"><a href="#RV.__init__-14"><span class="linenos">14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV.__init__-15"><a href="#RV.__init__-15"><span class="linenos">15</span></a><span class="sd">        Initialize an RV with Op `op` and parents `*parents`.</span>
</span><span id="RV.__init__-16"><a href="#RV.__init__-16"><span class="linenos">16</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV.__init__-17"><a href="#RV.__init__-17"><span class="linenos">17</span></a>
</span><span id="RV.__init__-18"><a href="#RV.__init__-18"><span class="linenos">18</span></a>        <span class="n">parents_shapes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">)</span>
</span><span id="RV.__init__-19"><a href="#RV.__init__-19"><span class="linenos">19</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">parents_shapes</span><span class="p">)</span>
</span><span id="RV.__init__-20"><a href="#RV.__init__-20"><span class="linenos">20</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
</span><span id="RV.__init__-21"><a href="#RV.__init__-21"><span class="linenos">21</span></a>        <span class="s2">&quot;The Op corresponding to this RV.&quot;</span>
</span><span id="RV.__init__-22"><a href="#RV.__init__-22"><span class="linenos">22</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">parents</span><span class="p">)</span>
</span><span id="RV.__init__-23"><a href="#RV.__init__-23"><span class="linenos">23</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frozen</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Initialize an RV with Op <code><a href="#RV.op">op</a></code> and parents <code>*parents</code>.</p>
</div>


                            </div>
                            <div id="RV.op" class="classattr">
                                <div class="attr variable">
            <span class="name">op</span>

        
    </div>
    <a class="headerlink" href="#RV.op"></a>
    
            <div class="docstring"><p>The Op corresponding to this RV.</p>
</div>


                            </div>
                            <div id="RV.shape" class="classattr">
                                        <input id="RV.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span>

                <label class="view-source-button" for="RV.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RV.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RV.shape-25"><a href="#RV.shape-25"><span class="linenos">25</span></a>    <span class="nd">@property</span>
</span><span id="RV.shape-26"><a href="#RV.shape-26"><span class="linenos">26</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV.shape-27"><a href="#RV.shape-27"><span class="linenos">27</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV.shape-28"><a href="#RV.shape-28"><span class="linenos">28</span></a><span class="sd">        The shape of the RV. (A tuple of ints.)</span>
</span><span id="RV.shape-29"><a href="#RV.shape-29"><span class="linenos">29</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV.shape-30"><a href="#RV.shape-30"><span class="linenos">30</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>
</span></pre></div>


            <div class="docstring"><p>The shape of the RV. (A tuple of ints.)</p>
</div>


                            </div>
                            <div id="RV.ndim" class="classattr">
                                        <input id="RV.ndim-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ndim</span>

                <label class="view-source-button" for="RV.ndim-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RV.ndim"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RV.ndim-32"><a href="#RV.ndim-32"><span class="linenos">32</span></a>    <span class="nd">@property</span>
</span><span id="RV.ndim-33"><a href="#RV.ndim-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RV.ndim-34"><a href="#RV.ndim-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RV.ndim-35"><a href="#RV.ndim-35"><span class="linenos">35</span></a><span class="sd">        The number of dimensions of the RV. Equal to the length of `shape`.</span>
</span><span id="RV.ndim-36"><a href="#RV.ndim-36"><span class="linenos">36</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RV.ndim-37"><a href="#RV.ndim-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The number of dimensions of the RV. Equal to the length of <code><a href="#RV.shape">shape</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="Constant">
                            <input id="Constant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Constant</span><wbr>(<span class="base"><a href="#Op">pangolin.ir.Op</a></span>):

                <label class="view-source-button" for="Constant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Constant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Constant-12"><a href="#Constant-12"><span class="linenos">12</span></a><span class="k">class</span> <span class="nc">Constant</span><span class="p">(</span><span class="n">ir</span><span class="o">.</span><span class="n">Op</span><span class="p">):</span>
</span><span id="Constant-13"><a href="#Constant-13"><span class="linenos">13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Constant-14"><a href="#Constant-14"><span class="linenos">14</span></a><span class="sd">    Represents a &quot;constant&quot; distribution. Has no parents. Data is always stored as a</span>
</span><span id="Constant-15"><a href="#Constant-15"><span class="linenos">15</span></a><span class="sd">    numpy array. You can switch it to use jax&#39;s version of numpy by setting `ir.np =</span>
</span><span id="Constant-16"><a href="#Constant-16"><span class="linenos">16</span></a><span class="sd">    jax.numpy`.</span>
</span><span id="Constant-17"><a href="#Constant-17"><span class="linenos">17</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Constant-18"><a href="#Constant-18"><span class="linenos">18</span></a>
</span><span id="Constant-19"><a href="#Constant-19"><span class="linenos">19</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="Constant-20"><a href="#Constant-20"><span class="linenos">20</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Constant-21"><a href="#Constant-21"><span class="linenos">21</span></a><span class="sd">        Create a Constant distribution.</span>
</span><span id="Constant-22"><a href="#Constant-22"><span class="linenos">22</span></a><span class="sd">        Parameters</span>
</span><span id="Constant-23"><a href="#Constant-23"><span class="linenos">23</span></a><span class="sd">        ----------</span>
</span><span id="Constant-24"><a href="#Constant-24"><span class="linenos">24</span></a><span class="sd">        value</span>
</span><span id="Constant-25"><a href="#Constant-25"><span class="linenos">25</span></a><span class="sd">            Some constant value that is either a numpy array or something that can be casted to a</span>
</span><span id="Constant-26"><a href="#Constant-26"><span class="linenos">26</span></a><span class="sd">            numpy array.</span>
</span><span id="Constant-27"><a href="#Constant-27"><span class="linenos">27</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Constant-28"><a href="#Constant-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="Constant-29"><a href="#Constant-29"><span class="linenos">29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The actual stored data, stored as an immutable numpy array&quot;&quot;&quot;</span>
</span><span id="Constant-30"><a href="#Constant-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Constant-31"><a href="#Constant-31"><span class="linenos">31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Constant-32"><a href="#Constant-32"><span class="linenos">32</span></a>
</span><span id="Constant-33"><a href="#Constant-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">parents_shapes</span><span class="p">):</span>
</span><span id="Constant-34"><a href="#Constant-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
</span><span id="Constant-35"><a href="#Constant-35"><span class="linenos">35</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents_shapes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Constant-36"><a href="#Constant-36"><span class="linenos">36</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Constant got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">parents_shapes</span><span class="p">)</span><span class="si">}</span><span class="s2"> arguments but expected 0.&quot;</span><span class="p">)</span>
</span><span id="Constant-37"><a href="#Constant-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Constant-38"><a href="#Constant-38"><span class="linenos">38</span></a>
</span><span id="Constant-39"><a href="#Constant-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Constant-40"><a href="#Constant-40"><span class="linenos">40</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Constant</span><span class="p">):</span>
</span><span id="Constant-41"><a href="#Constant-41"><span class="linenos">41</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
</span><span id="Constant-42"><a href="#Constant-42"><span class="linenos">42</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
</span><span id="Constant-43"><a href="#Constant-43"><span class="linenos">43</span></a>            <span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
</span><span id="Constant-44"><a href="#Constant-44"><span class="linenos">44</span></a>                <span class="k">assert</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="s2">&quot;hashes don&#39;t match for equal Constant&quot;</span>
</span><span id="Constant-45"><a href="#Constant-45"><span class="linenos">45</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Constant-46"><a href="#Constant-46"><span class="linenos">46</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Constant-47"><a href="#Constant-47"><span class="linenos">47</span></a>
</span><span id="Constant-48"><a href="#Constant-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Constant-49"><a href="#Constant-49"><span class="linenos">49</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</span><span id="Constant-50"><a href="#Constant-50"><span class="linenos">50</span></a>
</span><span id="Constant-51"><a href="#Constant-51"><span class="linenos">51</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Constant-52"><a href="#Constant-52"><span class="linenos">52</span></a>        <span class="c1"># assure regular old numpy in case jax being used</span>
</span><span id="Constant-53"><a href="#Constant-53"><span class="linenos">53</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Constant-54"><a href="#Constant-54"><span class="linenos">54</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;Constant(&quot;</span>
</span><span id="Constant-55"><a href="#Constant-55"><span class="linenos">55</span></a>            <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">edgeitems</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="Constant-56"><a href="#Constant-56"><span class="linenos">56</span></a>                <span class="n">ret</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Constant-57"><a href="#Constant-57"><span class="linenos">57</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;)&#39;</span>
</span><span id="Constant-58"><a href="#Constant-58"><span class="linenos">58</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="Constant-59"><a href="#Constant-59"><span class="linenos">59</span></a>
</span><span id="Constant-60"><a href="#Constant-60"><span class="linenos">60</span></a>        <span class="n">numpy_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Constant-61"><a href="#Constant-61"><span class="linenos">61</span></a>        <span class="n">array_str</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">numpy_value</span><span class="p">)</span>  <span class="c1"># get base string</span>
</span><span id="Constant-62"><a href="#Constant-62"><span class="linenos">62</span></a>        <span class="n">array_str</span> <span class="o">=</span> <span class="n">array_str</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># cut off &quot;array(&quot; and &quot;)&quot;</span>
</span><span id="Constant-63"><a href="#Constant-63"><span class="linenos">63</span></a>        <span class="n">array_str</span> <span class="o">=</span> <span class="n">array_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># remove newlines</span>
</span><span id="Constant-64"><a href="#Constant-64"><span class="linenos">64</span></a>        <span class="n">array_str</span> <span class="o">=</span> <span class="n">array_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># remove specs</span>
</span><span id="Constant-65"><a href="#Constant-65"><span class="linenos">65</span></a>        <span class="k">return</span> <span class="s2">&quot;Constant(&quot;</span> <span class="o">+</span> <span class="n">array_str</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="Constant-66"><a href="#Constant-66"><span class="linenos">66</span></a>
</span><span id="Constant-67"><a href="#Constant-67"><span class="linenos">67</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Constant-68"><a href="#Constant-68"><span class="linenos">68</span></a>        <span class="c1"># return str(self.value).replace(&quot;\n&quot;, &quot;&quot;).replace(&quot;  &quot;, &quot; &quot;)</span>
</span><span id="Constant-69"><a href="#Constant-69"><span class="linenos">69</span></a>        <span class="c1"># assure regular old numpy in case jax being used</span>
</span><span id="Constant-70"><a href="#Constant-70"><span class="linenos">70</span></a>        <span class="n">numpy_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Constant-71"><a href="#Constant-71"><span class="linenos">71</span></a>        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">edgeitems</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="Constant-72"><a href="#Constant-72"><span class="linenos">72</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="n">numpy_value</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Represents a "constant" distribution. Has no parents. Data is always stored as a
numpy array. You can switch it to use jax's version of numpy by setting <code>ir.np =
jax.numpy</code>.</p>
</div>


                            <div id="Constant.__init__" class="classattr">
                                        <input id="Constant.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Constant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span></span>)</span>

                <label class="view-source-button" for="Constant.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Constant.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Constant.__init__-19"><a href="#Constant.__init__-19"><span class="linenos">19</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="Constant.__init__-20"><a href="#Constant.__init__-20"><span class="linenos">20</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Constant.__init__-21"><a href="#Constant.__init__-21"><span class="linenos">21</span></a><span class="sd">        Create a Constant distribution.</span>
</span><span id="Constant.__init__-22"><a href="#Constant.__init__-22"><span class="linenos">22</span></a><span class="sd">        Parameters</span>
</span><span id="Constant.__init__-23"><a href="#Constant.__init__-23"><span class="linenos">23</span></a><span class="sd">        ----------</span>
</span><span id="Constant.__init__-24"><a href="#Constant.__init__-24"><span class="linenos">24</span></a><span class="sd">        value</span>
</span><span id="Constant.__init__-25"><a href="#Constant.__init__-25"><span class="linenos">25</span></a><span class="sd">            Some constant value that is either a numpy array or something that can be casted to a</span>
</span><span id="Constant.__init__-26"><a href="#Constant.__init__-26"><span class="linenos">26</span></a><span class="sd">            numpy array.</span>
</span><span id="Constant.__init__-27"><a href="#Constant.__init__-27"><span class="linenos">27</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Constant.__init__-28"><a href="#Constant.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="Constant.__init__-29"><a href="#Constant.__init__-29"><span class="linenos">29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The actual stored data, stored as an immutable numpy array&quot;&quot;&quot;</span>
</span><span id="Constant.__init__-30"><a href="#Constant.__init__-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Constant.__init__-31"><a href="#Constant.__init__-31"><span class="linenos">31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a Constant distribution.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong>: Some constant value that is either a numpy array or something that can be casted to a
numpy array.</li>
</ul>
</div>


                            </div>
                            <div id="Constant.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span>

        
    </div>
    <a class="headerlink" href="#Constant.value"></a>
    
            <div class="docstring"><p>The actual stored data, stored as an immutable numpy array</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Op">Op</a></dt>
                                <dd id="Constant.name" class="variable"><a href="#Op.name">name</a></dd>
                <dd id="Constant.random" class="variable"><a href="#Op.random">random</a></dd>
                <dd id="Constant.get_shape" class="function"><a href="#Op.get_shape">get_shape</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="VMap">
                            <input id="VMap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VMap</span><wbr>(<span class="base"><a href="#Op">pangolin.ir.Op</a></span>):

                <label class="view-source-button" for="VMap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VMap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VMap-8"><a href="#VMap-8"><span class="linenos"> 8</span></a><span class="k">class</span> <span class="nc">VMap</span><span class="p">(</span><span class="n">Op</span><span class="p">):</span>
</span><span id="VMap-9"><a href="#VMap-9"><span class="linenos"> 9</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VMap-10"><a href="#VMap-10"><span class="linenos">10</span></a><span class="sd">    Represents a `VMap` Op. That&#39;s *one specific* op vectorized over some number of arguments.</span>
</span><span id="VMap-11"><a href="#VMap-11"><span class="linenos">11</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="VMap-12"><a href="#VMap-12"><span class="linenos">12</span></a>
</span><span id="VMap-13"><a href="#VMap-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_op</span><span class="p">:</span> <span class="n">Op</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">axis_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="VMap-14"><a href="#VMap-14"><span class="linenos">14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VMap-15"><a href="#VMap-15"><span class="linenos">15</span></a><span class="sd">        Create a `VMap` Op. All arguments here are heavily inspired by [`jax.lax.vmap`](</span>
</span><span id="VMap-16"><a href="#VMap-16"><span class="linenos">16</span></a><span class="sd">        https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html) although note that</span>
</span><span id="VMap-17"><a href="#VMap-17"><span class="linenos">17</span></a><span class="sd">        `VMap` only maps a single `Op`. (The `vmap` function defined elsewhere takes an arbitrary</span>
</span><span id="VMap-18"><a href="#VMap-18"><span class="linenos">18</span></a><span class="sd">        function and transforms it into a graph of RVs with `VMap` `Op`s.)</span>
</span><span id="VMap-19"><a href="#VMap-19"><span class="linenos">19</span></a><span class="sd">        Parameters</span>
</span><span id="VMap-20"><a href="#VMap-20"><span class="linenos">20</span></a><span class="sd">        ----------</span>
</span><span id="VMap-21"><a href="#VMap-21"><span class="linenos">21</span></a><span class="sd">        base_op: Op</span>
</span><span id="VMap-22"><a href="#VMap-22"><span class="linenos">22</span></a><span class="sd">            The `Op` to be mapped</span>
</span><span id="VMap-23"><a href="#VMap-23"><span class="linenos">23</span></a><span class="sd">        in_axes: tuple[int | None, ...] | list[int | None, ...]</span>
</span><span id="VMap-24"><a href="#VMap-24"><span class="linenos">24</span></a><span class="sd">            What axis to map for each argument of the op (each can be a non-negative int or</span>
</span><span id="VMap-25"><a href="#VMap-25"><span class="linenos">25</span></a><span class="sd">            `None`)</span>
</span><span id="VMap-26"><a href="#VMap-26"><span class="linenos">26</span></a><span class="sd">        axis_size: int | None</span>
</span><span id="VMap-27"><a href="#VMap-27"><span class="linenos">27</span></a><span class="sd">            The size of the mapped axis/axes. Optional unless all elements of `in_axes` are `None`.</span>
</span><span id="VMap-28"><a href="#VMap-28"><span class="linenos">28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VMap-29"><a href="#VMap-29"><span class="linenos">29</span></a>
</span><span id="VMap-30"><a href="#VMap-30"><span class="linenos">30</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_op</span><span class="p">,</span> <span class="n">Op</span><span class="p">)</span>
</span><span id="VMap-31"><a href="#VMap-31"><span class="linenos">31</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_axes</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="VMap-32"><a href="#VMap-32"><span class="linenos">32</span></a>            <span class="n">in_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">in_axes</span><span class="p">)</span>
</span><span id="VMap-33"><a href="#VMap-33"><span class="linenos">33</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_axes</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="s2">&quot;in_axes must be tuple&quot;</span>
</span><span id="VMap-34"><a href="#VMap-34"><span class="linenos">34</span></a>        <span class="k">if</span> <span class="n">axis_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="VMap-35"><a href="#VMap-35"><span class="linenos">35</span></a>            <span class="k">assert</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="VMap-36"><a href="#VMap-36"><span class="linenos">36</span></a>                <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">in_axes</span>
</span><span id="VMap-37"><a href="#VMap-37"><span class="linenos">37</span></a>            <span class="p">),</span> <span class="s2">&quot;if axis_size=None, at least one axis must be mapped&quot;</span>
</span><span id="VMap-38"><a href="#VMap-38"><span class="linenos">38</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VMap-39"><a href="#VMap-39"><span class="linenos">39</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
</span><span id="VMap-40"><a href="#VMap-40"><span class="linenos">40</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;axis_size must be None or int was </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">axis_size</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="VMap-41"><a href="#VMap-41"><span class="linenos">41</span></a>
</span><span id="VMap-42"><a href="#VMap-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span> <span class="o">=</span> <span class="n">base_op</span>
</span><span id="VMap-43"><a href="#VMap-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span> <span class="o">=</span> <span class="n">in_axes</span>
</span><span id="VMap-44"><a href="#VMap-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span> <span class="o">=</span> <span class="n">axis_size</span>
</span><span id="VMap-45"><a href="#VMap-45"><span class="linenos">45</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">base_op</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span><span id="VMap-46"><a href="#VMap-46"><span class="linenos">46</span></a>
</span><span id="VMap-47"><a href="#VMap-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parents_shapes</span><span class="p">):</span>
</span><span id="VMap-48"><a href="#VMap-48"><span class="linenos">48</span></a>        <span class="n">remaining_shapes</span><span class="p">,</span> <span class="n">axis_size</span> <span class="o">=</span> <span class="n">get_sliced_shapes</span><span class="p">(</span>
</span><span id="VMap-49"><a href="#VMap-49"><span class="linenos">49</span></a>            <span class="n">parents_shapes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span>
</span><span id="VMap-50"><a href="#VMap-50"><span class="linenos">50</span></a>        <span class="p">)</span>
</span><span id="VMap-51"><a href="#VMap-51"><span class="linenos">51</span></a>        <span class="n">dummy_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">remaining_shapes</span><span class="p">)</span>
</span><span id="VMap-52"><a href="#VMap-52"><span class="linenos">52</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">axis_size</span><span class="p">,)</span> <span class="o">+</span> <span class="n">dummy_shape</span>
</span><span id="VMap-53"><a href="#VMap-53"><span class="linenos">53</span></a>
</span><span id="VMap-54"><a href="#VMap-54"><span class="linenos">54</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VMap-55"><a href="#VMap-55"><span class="linenos">55</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;VMap(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="VMap-56"><a href="#VMap-56"><span class="linenos">56</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span><span class="p">:</span>
</span><span id="VMap-57"><a href="#VMap-57"><span class="linenos">57</span></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;,</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="VMap-58"><a href="#VMap-58"><span class="linenos">58</span></a>        <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="VMap-59"><a href="#VMap-59"><span class="linenos">59</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="VMap-60"><a href="#VMap-60"><span class="linenos">60</span></a>
</span><span id="VMap-61"><a href="#VMap-61"><span class="linenos">61</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VMap-62"><a href="#VMap-62"><span class="linenos">62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VMap-63"><a href="#VMap-63"><span class="linenos">63</span></a><span class="sd">        Return a string representation of the VMap op. Just like `__repr__`` except (1) uses str</span>
</span><span id="VMap-64"><a href="#VMap-64"><span class="linenos">64</span></a><span class="sd">        for calling the recursive distribution and (2) uses a symbol &#39;∅&#39; instead of `None` for</span>
</span><span id="VMap-65"><a href="#VMap-65"><span class="linenos">65</span></a><span class="sd">        representing unmapped args</span>
</span><span id="VMap-66"><a href="#VMap-66"><span class="linenos">66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VMap-67"><a href="#VMap-67"><span class="linenos">67</span></a>        <span class="c1"># this is kind of overkill but whatever...</span>
</span><span id="VMap-68"><a href="#VMap-68"><span class="linenos">68</span></a>        <span class="n">new_in_axes</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span>
</span><span id="VMap-69"><a href="#VMap-69"><span class="linenos">69</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;∅&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
</span><span id="VMap-70"><a href="#VMap-70"><span class="linenos">70</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="p">,</span>
</span><span id="VMap-71"><a href="#VMap-71"><span class="linenos">71</span></a>            <span class="n">is_leaf</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">is_leaf_with_none</span><span class="p">,</span>
</span><span id="VMap-72"><a href="#VMap-72"><span class="linenos">72</span></a>        <span class="p">)</span>
</span><span id="VMap-73"><a href="#VMap-73"><span class="linenos">73</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;VMap(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">new_in_axes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="VMap-74"><a href="#VMap-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span><span class="p">:</span>
</span><span id="VMap-75"><a href="#VMap-75"><span class="linenos">75</span></a>            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;,</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="VMap-76"><a href="#VMap-76"><span class="linenos">76</span></a>        <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="VMap-77"><a href="#VMap-77"><span class="linenos">77</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="VMap-78"><a href="#VMap-78"><span class="linenos">78</span></a>
</span><span id="VMap-79"><a href="#VMap-79"><span class="linenos">79</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="VMap-80"><a href="#VMap-80"><span class="linenos">80</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">VMap</span><span class="p">):</span>
</span><span id="VMap-81"><a href="#VMap-81"><span class="linenos">81</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="VMap-82"><a href="#VMap-82"><span class="linenos">82</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">base_op</span>
</span><span id="VMap-83"><a href="#VMap-83"><span class="linenos">83</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">in_axes</span>
</span><span id="VMap-84"><a href="#VMap-84"><span class="linenos">84</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">axis_size</span>
</span><span id="VMap-85"><a href="#VMap-85"><span class="linenos">85</span></a>            <span class="p">)</span>
</span><span id="VMap-86"><a href="#VMap-86"><span class="linenos">86</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="VMap-87"><a href="#VMap-87"><span class="linenos">87</span></a>
</span><span id="VMap-88"><a href="#VMap-88"><span class="linenos">88</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VMap-89"><a href="#VMap-89"><span class="linenos">89</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Represents a <code><a href="#VMap">VMap</a></code> Op. That's <em>one specific</em> op vectorized over some number of arguments.</p>
</div>


                            <div id="VMap.__init__" class="classattr">
                                        <input id="VMap.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">VMap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_op</span><span class="p">:</span> <span class="n"><a href="#Op">Op</a></span>,</span><span class="param">	<span class="n">in_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="VMap.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VMap.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VMap.__init__-13"><a href="#VMap.__init__-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_op</span><span class="p">:</span> <span class="n">Op</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">axis_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="VMap.__init__-14"><a href="#VMap.__init__-14"><span class="linenos">14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VMap.__init__-15"><a href="#VMap.__init__-15"><span class="linenos">15</span></a><span class="sd">        Create a `VMap` Op. All arguments here are heavily inspired by [`jax.lax.vmap`](</span>
</span><span id="VMap.__init__-16"><a href="#VMap.__init__-16"><span class="linenos">16</span></a><span class="sd">        https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html) although note that</span>
</span><span id="VMap.__init__-17"><a href="#VMap.__init__-17"><span class="linenos">17</span></a><span class="sd">        `VMap` only maps a single `Op`. (The `vmap` function defined elsewhere takes an arbitrary</span>
</span><span id="VMap.__init__-18"><a href="#VMap.__init__-18"><span class="linenos">18</span></a><span class="sd">        function and transforms it into a graph of RVs with `VMap` `Op`s.)</span>
</span><span id="VMap.__init__-19"><a href="#VMap.__init__-19"><span class="linenos">19</span></a><span class="sd">        Parameters</span>
</span><span id="VMap.__init__-20"><a href="#VMap.__init__-20"><span class="linenos">20</span></a><span class="sd">        ----------</span>
</span><span id="VMap.__init__-21"><a href="#VMap.__init__-21"><span class="linenos">21</span></a><span class="sd">        base_op: Op</span>
</span><span id="VMap.__init__-22"><a href="#VMap.__init__-22"><span class="linenos">22</span></a><span class="sd">            The `Op` to be mapped</span>
</span><span id="VMap.__init__-23"><a href="#VMap.__init__-23"><span class="linenos">23</span></a><span class="sd">        in_axes: tuple[int | None, ...] | list[int | None, ...]</span>
</span><span id="VMap.__init__-24"><a href="#VMap.__init__-24"><span class="linenos">24</span></a><span class="sd">            What axis to map for each argument of the op (each can be a non-negative int or</span>
</span><span id="VMap.__init__-25"><a href="#VMap.__init__-25"><span class="linenos">25</span></a><span class="sd">            `None`)</span>
</span><span id="VMap.__init__-26"><a href="#VMap.__init__-26"><span class="linenos">26</span></a><span class="sd">        axis_size: int | None</span>
</span><span id="VMap.__init__-27"><a href="#VMap.__init__-27"><span class="linenos">27</span></a><span class="sd">            The size of the mapped axis/axes. Optional unless all elements of `in_axes` are `None`.</span>
</span><span id="VMap.__init__-28"><a href="#VMap.__init__-28"><span class="linenos">28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VMap.__init__-29"><a href="#VMap.__init__-29"><span class="linenos">29</span></a>
</span><span id="VMap.__init__-30"><a href="#VMap.__init__-30"><span class="linenos">30</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_op</span><span class="p">,</span> <span class="n">Op</span><span class="p">)</span>
</span><span id="VMap.__init__-31"><a href="#VMap.__init__-31"><span class="linenos">31</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_axes</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="VMap.__init__-32"><a href="#VMap.__init__-32"><span class="linenos">32</span></a>            <span class="n">in_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">in_axes</span><span class="p">)</span>
</span><span id="VMap.__init__-33"><a href="#VMap.__init__-33"><span class="linenos">33</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_axes</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="s2">&quot;in_axes must be tuple&quot;</span>
</span><span id="VMap.__init__-34"><a href="#VMap.__init__-34"><span class="linenos">34</span></a>        <span class="k">if</span> <span class="n">axis_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="VMap.__init__-35"><a href="#VMap.__init__-35"><span class="linenos">35</span></a>            <span class="k">assert</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="VMap.__init__-36"><a href="#VMap.__init__-36"><span class="linenos">36</span></a>                <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">in_axes</span>
</span><span id="VMap.__init__-37"><a href="#VMap.__init__-37"><span class="linenos">37</span></a>            <span class="p">),</span> <span class="s2">&quot;if axis_size=None, at least one axis must be mapped&quot;</span>
</span><span id="VMap.__init__-38"><a href="#VMap.__init__-38"><span class="linenos">38</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VMap.__init__-39"><a href="#VMap.__init__-39"><span class="linenos">39</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
</span><span id="VMap.__init__-40"><a href="#VMap.__init__-40"><span class="linenos">40</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;axis_size must be None or int was </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">axis_size</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="VMap.__init__-41"><a href="#VMap.__init__-41"><span class="linenos">41</span></a>
</span><span id="VMap.__init__-42"><a href="#VMap.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span> <span class="o">=</span> <span class="n">base_op</span>
</span><span id="VMap.__init__-43"><a href="#VMap.__init__-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span> <span class="o">=</span> <span class="n">in_axes</span>
</span><span id="VMap.__init__-44"><a href="#VMap.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">axis_size</span> <span class="o">=</span> <span class="n">axis_size</span>
</span><span id="VMap.__init__-45"><a href="#VMap.__init__-45"><span class="linenos">45</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">base_op</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a <code><a href="#VMap">VMap</a></code> Op. All arguments here are heavily inspired by <a href="a href=&quot;https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html&quot;&gt;https://jax.readthedocs.io/en/latest/_autosummary/jax.vmap.html&lt;/a"><code>jax.lax.vmap</code></a> although note that
<code><a href="#VMap">VMap</a></code> only maps a single <code><a href="#Op">Op</a></code>. (The <code>vmap</code> function defined elsewhere takes an arbitrary
function and transforms it into a graph of RVs with <code><a href="#VMap">VMap</a></code> <code><a href="#Op">Op</a></code>s.)</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_op</strong> (Op):
The <code><a href="#Op">Op</a></code> to be mapped</li>
<li><strong>in_axes</strong> (tuple[int | None, ...] | list[int | None, ...]):
What axis to map for each argument of the op (each can be a non-negative int or
<code>None</code>)</li>
<li><strong>axis_size</strong> (int | None):
The size of the mapped axis/axes. Optional unless all elements of <code><a href="#VMap.in_axes">in_axes</a></code> are <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="VMap.base_op" class="classattr">
                                <div class="attr variable">
            <span class="name">base_op</span>

        
    </div>
    <a class="headerlink" href="#VMap.base_op"></a>
    
    

                            </div>
                            <div id="VMap.in_axes" class="classattr">
                                <div class="attr variable">
            <span class="name">in_axes</span>

        
    </div>
    <a class="headerlink" href="#VMap.in_axes"></a>
    
    

                            </div>
                            <div id="VMap.axis_size" class="classattr">
                                <div class="attr variable">
            <span class="name">axis_size</span>

        
    </div>
    <a class="headerlink" href="#VMap.axis_size"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Op">Op</a></dt>
                                <dd id="VMap.name" class="variable"><a href="#Op.name">name</a></dd>
                <dd id="VMap.random" class="variable"><a href="#Op.random">random</a></dd>
                <dd id="VMap.get_shape" class="function"><a href="#Op.get_shape">get_shape</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Add">
                    <div class="attr variable">
            <span class="name">Add</span>        =
<span class="default_value">&lt;class &#39;<a href="ir/scalar_ops.html#all_scalar_op_factory">pangolin.ir.scalar_ops.all_scalar_op_factory</a>.&lt;locals&gt;.AllScalarOp&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Add"></a>
    
    

                </section>
                <section id="Index">
                            <input id="Index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Index</span><wbr>(<span class="base"><a href="#Op">pangolin.ir.Op</a></span>):

                <label class="view-source-button" for="Index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Index-95"><a href="#Index-95"><span class="linenos"> 95</span></a><span class="k">class</span> <span class="nc">Index</span><span class="p">(</span><span class="n">Op</span><span class="p">):</span>
</span><span id="Index-96"><a href="#Index-96"><span class="linenos"> 96</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Index-97"><a href="#Index-97"><span class="linenos"> 97</span></a><span class="sd">    Represents an `Op` to index into a `RV`. Slices for all sliced dimensions</span>
</span><span id="Index-98"><a href="#Index-98"><span class="linenos"> 98</span></a><span class="sd">    must be baked into the Index op when created. Non sliced dimensions are not</span>
</span><span id="Index-99"><a href="#Index-99"><span class="linenos"> 99</span></a><span class="sd">    part of the `Op` (they can be random variables).</span>
</span><span id="Index-100"><a href="#Index-100"><span class="linenos">100</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Index-101"><a href="#Index-101"><span class="linenos">101</span></a>
</span><span id="Index-102"><a href="#Index-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">slices</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Index-103"><a href="#Index-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Index-104"><a href="#Index-104"><span class="linenos">104</span></a><span class="sd">        Create an Index op given a set of slices.</span>
</span><span id="Index-105"><a href="#Index-105"><span class="linenos">105</span></a>
</span><span id="Index-106"><a href="#Index-106"><span class="linenos">106</span></a><span class="sd">        Parameters</span>
</span><span id="Index-107"><a href="#Index-107"><span class="linenos">107</span></a><span class="sd">        ----------</span>
</span><span id="Index-108"><a href="#Index-108"><span class="linenos">108</span></a><span class="sd">        slices</span>
</span><span id="Index-109"><a href="#Index-109"><span class="linenos">109</span></a><span class="sd">            A list with length equal to the number of dimensions of the RV that</span>
</span><span id="Index-110"><a href="#Index-110"><span class="linenos">110</span></a><span class="sd">            is to be indexed. Each element must either be (a) a slice with fixed</span>
</span><span id="Index-111"><a href="#Index-111"><span class="linenos">111</span></a><span class="sd">            integer values or (b) None, indicating that the dimension will be</span>
</span><span id="Index-112"><a href="#Index-112"><span class="linenos">112</span></a><span class="sd">            indexed with a RV instead.</span>
</span><span id="Index-113"><a href="#Index-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Index-114"><a href="#Index-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="n">slices</span>
</span><span id="Index-115"><a href="#Index-115"><span class="linenos">115</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Index-116"><a href="#Index-116"><span class="linenos">116</span></a>
</span><span id="Index-117"><a href="#Index-117"><span class="linenos">117</span></a>    <span class="nd">@property</span>
</span><span id="Index-118"><a href="#Index-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">advanced_at_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Index-119"><a href="#Index-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Index-120"><a href="#Index-120"><span class="linenos">120</span></a>
</span><span id="Index-121"><a href="#Index-121"><span class="linenos">121</span></a><span class="sd">        Most people don&#39;t realize that this is how numpy works:</span>
</span><span id="Index-122"><a href="#Index-122"><span class="linenos">122</span></a>
</span><span id="Index-123"><a href="#Index-123"><span class="linenos">123</span></a><span class="sd">        Numpy rules say that if you have &quot;advanced indices&quot; (like `i`) above</span>
</span><span id="Index-124"><a href="#Index-124"><span class="linenos">124</span></a><span class="sd">        and they are *separated by a slice* then the dimension for the advanced</span>
</span><span id="Index-125"><a href="#Index-125"><span class="linenos">125</span></a><span class="sd">        index goes at the start. (This is what happens in the second case above.)</span>
</span><span id="Index-126"><a href="#Index-126"><span class="linenos">126</span></a><span class="sd">        Otherwise, all the indices go to the location of the first advanced index.</span>
</span><span id="Index-127"><a href="#Index-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Index-128"><a href="#Index-128"><span class="linenos">128</span></a>        <span class="n">num_advanced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Index-129"><a href="#Index-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="n">num_advanced</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Index-130"><a href="#Index-130"><span class="linenos">130</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Index-131"><a href="#Index-131"><span class="linenos">131</span></a>        <span class="n">first_advanced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Index-132"><a href="#Index-132"><span class="linenos">132</span></a>        <span class="n">slice_probe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">[</span><span class="n">first_advanced</span><span class="p">:</span> <span class="n">first_advanced</span> <span class="o">+</span> <span class="n">num_advanced</span><span class="p">]</span>
</span><span id="Index-133"><a href="#Index-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">slice_probe</span><span class="p">):</span>
</span><span id="Index-134"><a href="#Index-134"><span class="linenos">134</span></a>            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># in place</span>
</span><span id="Index-135"><a href="#Index-135"><span class="linenos">135</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Index-136"><a href="#Index-136"><span class="linenos">136</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Index-137"><a href="#Index-137"><span class="linenos">137</span></a>
</span><span id="Index-138"><a href="#Index-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_shape</span><span class="p">,</span> <span class="o">*</span><span class="n">indices_shapes</span><span class="p">):</span>
</span><span id="Index-139"><a href="#Index-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_shape</span><span class="p">):</span>
</span><span id="Index-140"><a href="#Index-140"><span class="linenos">140</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;number of slots doesn&#39;t match number of dims of var&quot;</span><span class="p">)</span>
</span><span id="Index-141"><a href="#Index-141"><span class="linenos">141</span></a>
</span><span id="Index-142"><a href="#Index-142"><span class="linenos">142</span></a>        <span class="k">for</span> <span class="n">idx_shape1</span> <span class="ow">in</span> <span class="n">indices_shapes</span><span class="p">:</span>
</span><span id="Index-143"><a href="#Index-143"><span class="linenos">143</span></a>            <span class="k">for</span> <span class="n">idx_shape2</span> <span class="ow">in</span> <span class="n">indices_shapes</span><span class="p">:</span>
</span><span id="Index-144"><a href="#Index-144"><span class="linenos">144</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Index-145"><a href="#Index-145"><span class="linenos">145</span></a>                        <span class="n">idx_shape1</span> <span class="o">==</span> <span class="n">idx_shape2</span>
</span><span id="Index-146"><a href="#Index-146"><span class="linenos">146</span></a>                <span class="p">),</span> <span class="s2">&quot;all indices must have same shape (no broadcasting yet)&quot;</span>
</span><span id="Index-147"><a href="#Index-147"><span class="linenos">147</span></a>
</span><span id="Index-148"><a href="#Index-148"><span class="linenos">148</span></a>        <span class="n">output_shape</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="Index-149"><a href="#Index-149"><span class="linenos">149</span></a>        <span class="n">idx_added</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Index-150"><a href="#Index-150"><span class="linenos">150</span></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">my_slice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">):</span>
</span><span id="Index-151"><a href="#Index-151"><span class="linenos">151</span></a>            <span class="k">if</span> <span class="n">my_slice</span><span class="p">:</span>
</span><span id="Index-152"><a href="#Index-152"><span class="linenos">152</span></a>                <span class="n">output_shape</span> <span class="o">+=</span> <span class="p">(</span><span class="n">_slice_length</span><span class="p">(</span><span class="n">var_shape</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">my_slice</span><span class="p">),)</span>
</span><span id="Index-153"><a href="#Index-153"><span class="linenos">153</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Index-154"><a href="#Index-154"><span class="linenos">154</span></a>                <span class="n">idx_shape</span> <span class="o">=</span> <span class="n">indices_shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># do here in case all sliced!</span>
</span><span id="Index-155"><a href="#Index-155"><span class="linenos">155</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">idx_added</span><span class="p">:</span>
</span><span id="Index-156"><a href="#Index-156"><span class="linenos">156</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">advanced_at_start</span><span class="p">:</span>
</span><span id="Index-157"><a href="#Index-157"><span class="linenos">157</span></a>                        <span class="n">output_shape</span> <span class="o">=</span> <span class="n">idx_shape</span> <span class="o">+</span> <span class="n">output_shape</span>
</span><span id="Index-158"><a href="#Index-158"><span class="linenos">158</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Index-159"><a href="#Index-159"><span class="linenos">159</span></a>                        <span class="n">output_shape</span> <span class="o">+=</span> <span class="n">idx_shape</span>
</span><span id="Index-160"><a href="#Index-160"><span class="linenos">160</span></a>                    <span class="n">idx_added</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Index-161"><a href="#Index-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="n">output_shape</span>
</span><span id="Index-162"><a href="#Index-162"><span class="linenos">162</span></a>
</span><span id="Index-163"><a href="#Index-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Index-164"><a href="#Index-164"><span class="linenos">164</span></a>        <span class="k">return</span> <span class="s2">&quot;Index(slices=&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="Index-165"><a href="#Index-165"><span class="linenos">165</span></a>
</span><span id="Index-166"><a href="#Index-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Index-167"><a href="#Index-167"><span class="linenos">167</span></a>        <span class="k">def</span> <span class="nf">slice_str</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="Index-168"><a href="#Index-168"><span class="linenos">168</span></a>            <span class="k">match</span> <span class="n">s</span><span class="p">:</span>
</span><span id="Index-169"><a href="#Index-169"><span class="linenos">169</span></a>                <span class="k">case</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Index-170"><a href="#Index-170"><span class="linenos">170</span></a>                    <span class="k">return</span> <span class="s2">&quot;∅&quot;</span>
</span><span id="Index-171"><a href="#Index-171"><span class="linenos">171</span></a>                <span class="k">case</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Index-172"><a href="#Index-172"><span class="linenos">172</span></a>                    <span class="k">return</span> <span class="s2">&quot;:&quot;</span>
</span><span id="Index-173"><a href="#Index-173"><span class="linenos">173</span></a>                <span class="k">case</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">c</span><span class="p">):</span>
</span><span id="Index-174"><a href="#Index-174"><span class="linenos">174</span></a>                    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Index-175"><a href="#Index-175"><span class="linenos">175</span></a>                        <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Index-176"><a href="#Index-176"><span class="linenos">176</span></a>                    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Index-177"><a href="#Index-177"><span class="linenos">177</span></a>                        <span class="n">b</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Index-178"><a href="#Index-178"><span class="linenos">178</span></a>                    <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Index-179"><a href="#Index-179"><span class="linenos">179</span></a>                        <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Index-180"><a href="#Index-180"><span class="linenos">180</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Index-181"><a href="#Index-181"><span class="linenos">181</span></a>                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="Index-182"><a href="#Index-182"><span class="linenos">182</span></a>                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;not a slice&quot;</span><span class="p">)</span>
</span><span id="Index-183"><a href="#Index-183"><span class="linenos">183</span></a>
</span><span id="Index-184"><a href="#Index-184"><span class="linenos">184</span></a>        <span class="n">new_slices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">slice_str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">)</span>
</span><span id="Index-185"><a href="#Index-185"><span class="linenos">185</span></a>        <span class="k">return</span> <span class="s2">&quot;index&quot;</span> <span class="o">+</span> <span class="n">util</span><span class="o">.</span><span class="n">comma_separated</span><span class="p">(</span><span class="n">new_slices</span><span class="p">)</span>
</span><span id="Index-186"><a href="#Index-186"><span class="linenos">186</span></a>
</span><span id="Index-187"><a href="#Index-187"><span class="linenos">187</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Index-188"><a href="#Index-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Index</span><span class="p">):</span>
</span><span id="Index-189"><a href="#Index-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">slices</span>
</span><span id="Index-190"><a href="#Index-190"><span class="linenos">190</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Index-191"><a href="#Index-191"><span class="linenos">191</span></a>
</span><span id="Index-192"><a href="#Index-192"><span class="linenos">192</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Index-193"><a href="#Index-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Represents an <code><a href="#Op">Op</a></code> to index into a <code><a href="#RV">RV</a></code>. Slices for all sliced dimensions
must be baked into the Index op when created. Non sliced dimensions are not
part of the <code><a href="#Op">Op</a></code> (they can be random variables).</p>
</div>


                            <div id="Index.__init__" class="classattr">
                                        <input id="Index.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Index</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">slices</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">|</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Index.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Index.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Index.__init__-102"><a href="#Index.__init__-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">slices</span><span class="p">:</span> <span class="nb">slice</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Index.__init__-103"><a href="#Index.__init__-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Index.__init__-104"><a href="#Index.__init__-104"><span class="linenos">104</span></a><span class="sd">        Create an Index op given a set of slices.</span>
</span><span id="Index.__init__-105"><a href="#Index.__init__-105"><span class="linenos">105</span></a>
</span><span id="Index.__init__-106"><a href="#Index.__init__-106"><span class="linenos">106</span></a><span class="sd">        Parameters</span>
</span><span id="Index.__init__-107"><a href="#Index.__init__-107"><span class="linenos">107</span></a><span class="sd">        ----------</span>
</span><span id="Index.__init__-108"><a href="#Index.__init__-108"><span class="linenos">108</span></a><span class="sd">        slices</span>
</span><span id="Index.__init__-109"><a href="#Index.__init__-109"><span class="linenos">109</span></a><span class="sd">            A list with length equal to the number of dimensions of the RV that</span>
</span><span id="Index.__init__-110"><a href="#Index.__init__-110"><span class="linenos">110</span></a><span class="sd">            is to be indexed. Each element must either be (a) a slice with fixed</span>
</span><span id="Index.__init__-111"><a href="#Index.__init__-111"><span class="linenos">111</span></a><span class="sd">            integer values or (b) None, indicating that the dimension will be</span>
</span><span id="Index.__init__-112"><a href="#Index.__init__-112"><span class="linenos">112</span></a><span class="sd">            indexed with a RV instead.</span>
</span><span id="Index.__init__-113"><a href="#Index.__init__-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Index.__init__-114"><a href="#Index.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">slices</span> <span class="o">=</span> <span class="n">slices</span>
</span><span id="Index.__init__-115"><a href="#Index.__init__-115"><span class="linenos">115</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create an Index op given a set of slices.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>slices</strong>: A list with length equal to the number of dimensions of the RV that
is to be indexed. Each element must either be (a) a slice with fixed
integer values or (b) None, indicating that the dimension will be
indexed with a RV instead.</li>
</ul>
</div>


                            </div>
                            <div id="Index.slices" class="classattr">
                                <div class="attr variable">
            <span class="name">slices</span>

        
    </div>
    <a class="headerlink" href="#Index.slices"></a>
    
    

                            </div>
                            <div id="Index.advanced_at_start" class="classattr">
                                        <input id="Index.advanced_at_start-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">advanced_at_start</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="Index.advanced_at_start-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Index.advanced_at_start"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Index.advanced_at_start-117"><a href="#Index.advanced_at_start-117"><span class="linenos">117</span></a>    <span class="nd">@property</span>
</span><span id="Index.advanced_at_start-118"><a href="#Index.advanced_at_start-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">advanced_at_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Index.advanced_at_start-119"><a href="#Index.advanced_at_start-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Index.advanced_at_start-120"><a href="#Index.advanced_at_start-120"><span class="linenos">120</span></a>
</span><span id="Index.advanced_at_start-121"><a href="#Index.advanced_at_start-121"><span class="linenos">121</span></a><span class="sd">        Most people don&#39;t realize that this is how numpy works:</span>
</span><span id="Index.advanced_at_start-122"><a href="#Index.advanced_at_start-122"><span class="linenos">122</span></a>
</span><span id="Index.advanced_at_start-123"><a href="#Index.advanced_at_start-123"><span class="linenos">123</span></a><span class="sd">        Numpy rules say that if you have &quot;advanced indices&quot; (like `i`) above</span>
</span><span id="Index.advanced_at_start-124"><a href="#Index.advanced_at_start-124"><span class="linenos">124</span></a><span class="sd">        and they are *separated by a slice* then the dimension for the advanced</span>
</span><span id="Index.advanced_at_start-125"><a href="#Index.advanced_at_start-125"><span class="linenos">125</span></a><span class="sd">        index goes at the start. (This is what happens in the second case above.)</span>
</span><span id="Index.advanced_at_start-126"><a href="#Index.advanced_at_start-126"><span class="linenos">126</span></a><span class="sd">        Otherwise, all the indices go to the location of the first advanced index.</span>
</span><span id="Index.advanced_at_start-127"><a href="#Index.advanced_at_start-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Index.advanced_at_start-128"><a href="#Index.advanced_at_start-128"><span class="linenos">128</span></a>        <span class="n">num_advanced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Index.advanced_at_start-129"><a href="#Index.advanced_at_start-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="n">num_advanced</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Index.advanced_at_start-130"><a href="#Index.advanced_at_start-130"><span class="linenos">130</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Index.advanced_at_start-131"><a href="#Index.advanced_at_start-131"><span class="linenos">131</span></a>        <span class="n">first_advanced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Index.advanced_at_start-132"><a href="#Index.advanced_at_start-132"><span class="linenos">132</span></a>        <span class="n">slice_probe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slices</span><span class="p">[</span><span class="n">first_advanced</span><span class="p">:</span> <span class="n">first_advanced</span> <span class="o">+</span> <span class="n">num_advanced</span><span class="p">]</span>
</span><span id="Index.advanced_at_start-133"><a href="#Index.advanced_at_start-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">slice_probe</span><span class="p">):</span>
</span><span id="Index.advanced_at_start-134"><a href="#Index.advanced_at_start-134"><span class="linenos">134</span></a>            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># in place</span>
</span><span id="Index.advanced_at_start-135"><a href="#Index.advanced_at_start-135"><span class="linenos">135</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Index.advanced_at_start-136"><a href="#Index.advanced_at_start-136"><span class="linenos">136</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Most people don't realize that this is how numpy works:</p>

<p>Numpy rules say that if you have "advanced indices" (like <code>i</code>) above
and they are <em>separated by a slice</em> then the dimension for the advanced
index goes at the start. (This is what happens in the second case above.)
Otherwise, all the indices go to the location of the first advanced index.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Op">Op</a></dt>
                                <dd id="Index.name" class="variable"><a href="#Op.name">name</a></dd>
                <dd id="Index.random" class="variable"><a href="#Op.random">random</a></dd>
                <dd id="Index.get_shape" class="function"><a href="#Op.get_shape">get_shape</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Composite">
                            <input id="Composite-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Composite</span><wbr>(<span class="base"><a href="#Op">pangolin.ir.Op</a></span>):

                <label class="view-source-button" for="Composite-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Composite"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Composite-9"><a href="#Composite-9"><span class="linenos"> 9</span></a><span class="k">class</span> <span class="nc">Composite</span><span class="p">(</span><span class="n">Op</span><span class="p">):</span>
</span><span id="Composite-10"><a href="#Composite-10"><span class="linenos">10</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composite-11"><a href="#Composite-11"><span class="linenos">11</span></a><span class="sd">    A composite distribution can have any number of inputs. par_nums counts all the inputs first</span>
</span><span id="Composite-12"><a href="#Composite-12"><span class="linenos">12</span></a><span class="sd">    (in order) followed by the variables generated by the composite distribution itself</span>
</span><span id="Composite-13"><a href="#Composite-13"><span class="linenos">13</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Composite-14"><a href="#Composite-14"><span class="linenos">14</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Composite-15"><a href="#Composite-15"><span class="linenos">15</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Composite-16"><a href="#Composite-16"><span class="linenos">16</span></a>        <span class="n">num_inputs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Composite-17"><a href="#Composite-17"><span class="linenos">17</span></a>        <span class="n">ops</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Op</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Op</span><span class="p">],</span>
</span><span id="Composite-18"><a href="#Composite-18"><span class="linenos">18</span></a>        <span class="n">par_nums</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="Composite-19"><a href="#Composite-19"><span class="linenos">19</span></a>    <span class="p">):</span>
</span><span id="Composite-20"><a href="#Composite-20"><span class="linenos">20</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="Composite-21"><a href="#Composite-21"><span class="linenos">21</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Op</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">)</span>
</span><span id="Composite-22"><a href="#Composite-22"><span class="linenos">22</span></a>        <span class="k">for</span> <span class="n">my_par_nums</span> <span class="ow">in</span> <span class="n">par_nums</span><span class="p">:</span>
</span><span id="Composite-23"><a href="#Composite-23"><span class="linenos">23</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">my_par_nums</span><span class="p">)</span>
</span><span id="Composite-24"><a href="#Composite-24"><span class="linenos">24</span></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Composite-25"><a href="#Composite-25"><span class="linenos">25</span></a>            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">random</span><span class="p">:</span>
</span><span id="Composite-26"><a href="#Composite-26"><span class="linenos">26</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;all but last op for Composite must be non-random (got </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Composite-27"><a href="#Composite-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_inputs</span> <span class="o">=</span> <span class="n">num_inputs</span>
</span><span id="Composite-28"><a href="#Composite-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ops</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span>
</span><span id="Composite-29"><a href="#Composite-29"><span class="linenos">29</span></a>        <span class="c1">#self.par_nums = tuple(par_nums)</span>
</span><span id="Composite-30"><a href="#Composite-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">par_nums</span><span class="p">)</span>
</span><span id="Composite-31"><a href="#Composite-31"><span class="linenos">31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Composite(</span><span class="si">{</span><span class="n">ops</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">ops</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span><span id="Composite-32"><a href="#Composite-32"><span class="linenos">32</span></a>
</span><span id="Composite-33"><a href="#Composite-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">parents_shapes</span><span class="p">):</span>
</span><span id="Composite-34"><a href="#Composite-34"><span class="linenos">34</span></a>        <span class="n">all_shapes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parents_shapes</span><span class="p">)</span>
</span><span id="Composite-35"><a href="#Composite-35"><span class="linenos">35</span></a>        <span class="k">for</span> <span class="n">my_op</span><span class="p">,</span> <span class="n">my_par_nums</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span><span class="p">):</span>
</span><span id="Composite-36"><a href="#Composite-36"><span class="linenos">36</span></a>            <span class="n">my_parents_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_shapes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">my_par_nums</span><span class="p">]</span>
</span><span id="Composite-37"><a href="#Composite-37"><span class="linenos">37</span></a>            <span class="n">my_shape</span> <span class="o">=</span> <span class="n">my_op</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">my_parents_shapes</span><span class="p">)</span>
</span><span id="Composite-38"><a href="#Composite-38"><span class="linenos">38</span></a>            <span class="n">all_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_shape</span><span class="p">)</span>
</span><span id="Composite-39"><a href="#Composite-39"><span class="linenos">39</span></a>        <span class="k">return</span> <span class="n">all_shapes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Composite-40"><a href="#Composite-40"><span class="linenos">40</span></a>
</span><span id="Composite-41"><a href="#Composite-41"><span class="linenos">41</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Composite-42"><a href="#Composite-42"><span class="linenos">42</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;composite(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_inputs</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Composite-43"><a href="#Composite-43"><span class="linenos">43</span></a>
</span><span id="Composite-44"><a href="#Composite-44"><span class="linenos">44</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Composite-45"><a href="#Composite-45"><span class="linenos">45</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Composite(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_inputs</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Composite-46"><a href="#Composite-46"><span class="linenos">46</span></a>
</span><span id="Composite-47"><a href="#Composite-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Composite-48"><a href="#Composite-48"><span class="linenos">48</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Composite</span><span class="p">):</span>
</span><span id="Composite-49"><a href="#Composite-49"><span class="linenos">49</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Composite-50"><a href="#Composite-50"><span class="linenos">50</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">num_inputs</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">num_inputs</span>
</span><span id="Composite-51"><a href="#Composite-51"><span class="linenos">51</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ops</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ops</span>
</span><span id="Composite-52"><a href="#Composite-52"><span class="linenos">52</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">par_nums</span>
</span><span id="Composite-53"><a href="#Composite-53"><span class="linenos">53</span></a>            <span class="p">)</span>
</span><span id="Composite-54"><a href="#Composite-54"><span class="linenos">54</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Composite-55"><a href="#Composite-55"><span class="linenos">55</span></a>
</span><span id="Composite-56"><a href="#Composite-56"><span class="linenos">56</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Composite-57"><a href="#Composite-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>A composite distribution can have any number of inputs. par_nums counts all the inputs first
(in order) followed by the variables generated by the composite distribution itself</p>
</div>


                            <div id="Composite.__init__" class="classattr">
                                        <input id="Composite.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Composite</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">num_inputs</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">ops</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n"><a href="#Op">Op</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Op">Op</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">par_nums</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span></span>)</span>

                <label class="view-source-button" for="Composite.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Composite.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Composite.__init__-14"><a href="#Composite.__init__-14"><span class="linenos">14</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Composite.__init__-15"><a href="#Composite.__init__-15"><span class="linenos">15</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Composite.__init__-16"><a href="#Composite.__init__-16"><span class="linenos">16</span></a>        <span class="n">num_inputs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Composite.__init__-17"><a href="#Composite.__init__-17"><span class="linenos">17</span></a>        <span class="n">ops</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Op</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Op</span><span class="p">],</span>
</span><span id="Composite.__init__-18"><a href="#Composite.__init__-18"><span class="linenos">18</span></a>        <span class="n">par_nums</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="Composite.__init__-19"><a href="#Composite.__init__-19"><span class="linenos">19</span></a>    <span class="p">):</span>
</span><span id="Composite.__init__-20"><a href="#Composite.__init__-20"><span class="linenos">20</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="Composite.__init__-21"><a href="#Composite.__init__-21"><span class="linenos">21</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Op</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">)</span>
</span><span id="Composite.__init__-22"><a href="#Composite.__init__-22"><span class="linenos">22</span></a>        <span class="k">for</span> <span class="n">my_par_nums</span> <span class="ow">in</span> <span class="n">par_nums</span><span class="p">:</span>
</span><span id="Composite.__init__-23"><a href="#Composite.__init__-23"><span class="linenos">23</span></a>            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">my_par_nums</span><span class="p">)</span>
</span><span id="Composite.__init__-24"><a href="#Composite.__init__-24"><span class="linenos">24</span></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Composite.__init__-25"><a href="#Composite.__init__-25"><span class="linenos">25</span></a>            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">random</span><span class="p">:</span>
</span><span id="Composite.__init__-26"><a href="#Composite.__init__-26"><span class="linenos">26</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;all but last op for Composite must be non-random (got </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Composite.__init__-27"><a href="#Composite.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_inputs</span> <span class="o">=</span> <span class="n">num_inputs</span>
</span><span id="Composite.__init__-28"><a href="#Composite.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ops</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span>
</span><span id="Composite.__init__-29"><a href="#Composite.__init__-29"><span class="linenos">29</span></a>        <span class="c1">#self.par_nums = tuple(par_nums)</span>
</span><span id="Composite.__init__-30"><a href="#Composite.__init__-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">par_nums</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">par_nums</span><span class="p">)</span>
</span><span id="Composite.__init__-31"><a href="#Composite.__init__-31"><span class="linenos">31</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Composite(</span><span class="si">{</span><span class="n">ops</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">ops</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new op</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
name for the operator (used only for printing, not functionality)</li>
<li><strong>random</strong> (bool):
is this a conditional distribution? (<code>random=True</code>) or a deterministic function (
<code>random=False</code>)?</li>
</ul>
</div>


                            </div>
                            <div id="Composite.num_inputs" class="classattr">
                                <div class="attr variable">
            <span class="name">num_inputs</span>

        
    </div>
    <a class="headerlink" href="#Composite.num_inputs"></a>
    
    

                            </div>
                            <div id="Composite.ops" class="classattr">
                                <div class="attr variable">
            <span class="name">ops</span>

        
    </div>
    <a class="headerlink" href="#Composite.ops"></a>
    
    

                            </div>
                            <div id="Composite.par_nums" class="classattr">
                                <div class="attr variable">
            <span class="name">par_nums</span>

        
    </div>
    <a class="headerlink" href="#Composite.par_nums"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Op">Op</a></dt>
                                <dd id="Composite.name" class="variable"><a href="#Op.name">name</a></dd>
                <dd id="Composite.random" class="variable"><a href="#Op.random">random</a></dd>
                <dd id="Composite.get_shape" class="function"><a href="#Op.get_shape">get_shape</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Autoregressive">
                            <input id="Autoregressive-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Autoregressive</span><wbr>(<span class="base"><a href="#Op">pangolin.ir.Op</a></span>):

                <label class="view-source-button" for="Autoregressive-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Autoregressive"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Autoregressive-12"><a href="#Autoregressive-12"><span class="linenos">12</span></a><span class="k">class</span> <span class="nc">Autoregressive</span><span class="p">(</span><span class="n">Op</span><span class="p">):</span>
</span><span id="Autoregressive-13"><a href="#Autoregressive-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Autoregressive-14"><a href="#Autoregressive-14"><span class="linenos">14</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Autoregressive-15"><a href="#Autoregressive-15"><span class="linenos">15</span></a>        <span class="n">base_op</span><span class="p">:</span> <span class="n">Op</span><span class="p">,</span>
</span><span id="Autoregressive-16"><a href="#Autoregressive-16"><span class="linenos">16</span></a>        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Autoregressive-17"><a href="#Autoregressive-17"><span class="linenos">17</span></a>        <span class="n">in_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
</span><span id="Autoregressive-18"><a href="#Autoregressive-18"><span class="linenos">18</span></a>        <span class="n">where_self</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Autoregressive-19"><a href="#Autoregressive-19"><span class="linenos">19</span></a>    <span class="p">):</span>
</span><span id="Autoregressive-20"><a href="#Autoregressive-20"><span class="linenos">20</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Autoregressive-21"><a href="#Autoregressive-21"><span class="linenos">21</span></a><span class="sd">        base_cond_dist - what distribution to repeat on</span>
</span><span id="Autoregressive-22"><a href="#Autoregressive-22"><span class="linenos">22</span></a><span class="sd">        num_constants - number of constant arguments (default 0)</span>
</span><span id="Autoregressive-23"><a href="#Autoregressive-23"><span class="linenos">23</span></a><span class="sd">        length - the number of times to repeat (optional if there are )</span>
</span><span id="Autoregressive-24"><a href="#Autoregressive-24"><span class="linenos">24</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Autoregressive-25"><a href="#Autoregressive-25"><span class="linenos">25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span> <span class="o">=</span> <span class="n">base_op</span>
</span><span id="Autoregressive-26"><a href="#Autoregressive-26"><span class="linenos">26</span></a>        <span class="c1"># self.num_constants = num_constants</span>
</span><span id="Autoregressive-27"><a href="#Autoregressive-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
</span><span id="Autoregressive-28"><a href="#Autoregressive-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">in_axes</span><span class="p">)</span>
</span><span id="Autoregressive-29"><a href="#Autoregressive-29"><span class="linenos">29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">where_self</span> <span class="o">=</span> <span class="n">where_self</span>
</span><span id="Autoregressive-30"><a href="#Autoregressive-30"><span class="linenos">30</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Autoregressive(</span><span class="si">{</span><span class="n">base_op</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">base_op</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span><span id="Autoregressive-31"><a href="#Autoregressive-31"><span class="linenos">31</span></a>
</span><span id="Autoregressive-32"><a href="#Autoregressive-32"><span class="linenos">32</span></a>    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_shape</span><span class="p">,</span> <span class="o">*</span><span class="n">other_shapes</span><span class="p">):</span>
</span><span id="Autoregressive-33"><a href="#Autoregressive-33"><span class="linenos">33</span></a>        <span class="c1"># const_shapes = other_shapes[: self.num_constants]</span>
</span><span id="Autoregressive-34"><a href="#Autoregressive-34"><span class="linenos">34</span></a>        <span class="c1"># other_shapes = other_shapes[self.num_constants :]</span>
</span><span id="Autoregressive-35"><a href="#Autoregressive-35"><span class="linenos">35</span></a>
</span><span id="Autoregressive-36"><a href="#Autoregressive-36"><span class="linenos">36</span></a>        <span class="c1"># if self.length is None and other_shapes == ():</span>
</span><span id="Autoregressive-37"><a href="#Autoregressive-37"><span class="linenos">37</span></a>        <span class="c1">#     raise ValueError(&quot;Can&#39;t create Autoregressive with length=None and no mapped arguments&quot;)</span>
</span><span id="Autoregressive-38"><a href="#Autoregressive-38"><span class="linenos">38</span></a>        <span class="c1">#</span>
</span><span id="Autoregressive-39"><a href="#Autoregressive-39"><span class="linenos">39</span></a>        <span class="c1"># if self.length is None:</span>
</span><span id="Autoregressive-40"><a href="#Autoregressive-40"><span class="linenos">40</span></a>        <span class="c1">#     my_length = other_shapes[0][0]</span>
</span><span id="Autoregressive-41"><a href="#Autoregressive-41"><span class="linenos">41</span></a>        <span class="c1"># else:</span>
</span><span id="Autoregressive-42"><a href="#Autoregressive-42"><span class="linenos">42</span></a>        <span class="c1">#     my_length = self.length</span>
</span><span id="Autoregressive-43"><a href="#Autoregressive-43"><span class="linenos">43</span></a>
</span><span id="Autoregressive-44"><a href="#Autoregressive-44"><span class="linenos">44</span></a>        <span class="n">base_input_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Autoregressive-45"><a href="#Autoregressive-45"><span class="linenos">45</span></a>
</span><span id="Autoregressive-46"><a href="#Autoregressive-46"><span class="linenos">46</span></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">other_shapes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="p">,</span><span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
</span><span id="Autoregressive-47"><a href="#Autoregressive-47"><span class="linenos">47</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Autoregressive-48"><a href="#Autoregressive-48"><span class="linenos">48</span></a>                <span class="n">base_input_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="Autoregressive-49"><a href="#Autoregressive-49"><span class="linenos">49</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Autoregressive-50"><a href="#Autoregressive-50"><span class="linenos">50</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Autoregressive-51"><a href="#Autoregressive-51"><span class="linenos">51</span></a>                <span class="n">base_input_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="n">ax</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">ax</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:])</span>
</span><span id="Autoregressive-52"><a href="#Autoregressive-52"><span class="linenos">52</span></a>
</span><span id="Autoregressive-53"><a href="#Autoregressive-53"><span class="linenos">53</span></a>        <span class="c1"># insert self</span>
</span><span id="Autoregressive-54"><a href="#Autoregressive-54"><span class="linenos">54</span></a>        <span class="c1"># if n == self.where_self:</span>
</span><span id="Autoregressive-55"><a href="#Autoregressive-55"><span class="linenos">55</span></a>        <span class="c1">#    base_input_shapes.append(start_shape)</span>
</span><span id="Autoregressive-56"><a href="#Autoregressive-56"><span class="linenos">56</span></a>        <span class="n">base_input_shapes</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Autoregressive-57"><a href="#Autoregressive-57"><span class="linenos">57</span></a>            <span class="n">base_input_shapes</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">where_self</span><span class="p">]</span>
</span><span id="Autoregressive-58"><a href="#Autoregressive-58"><span class="linenos">58</span></a>            <span class="o">+</span> <span class="p">[</span><span class="n">start_shape</span><span class="p">]</span>
</span><span id="Autoregressive-59"><a href="#Autoregressive-59"><span class="linenos">59</span></a>            <span class="o">+</span> <span class="n">base_input_shapes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">where_self</span> <span class="p">:]</span>
</span><span id="Autoregressive-60"><a href="#Autoregressive-60"><span class="linenos">60</span></a>        <span class="p">)</span>
</span><span id="Autoregressive-61"><a href="#Autoregressive-61"><span class="linenos">61</span></a>
</span><span id="Autoregressive-62"><a href="#Autoregressive-62"><span class="linenos">62</span></a>        <span class="c1"># for s in other_shapes:</span>
</span><span id="Autoregressive-63"><a href="#Autoregressive-63"><span class="linenos">63</span></a>        <span class="c1">#    assert s[0] == my_length</span>
</span><span id="Autoregressive-64"><a href="#Autoregressive-64"><span class="linenos">64</span></a>        <span class="c1"># base_other_shapes = tuple(s[1:] for s in other_shapes)</span>
</span><span id="Autoregressive-65"><a href="#Autoregressive-65"><span class="linenos">65</span></a>
</span><span id="Autoregressive-66"><a href="#Autoregressive-66"><span class="linenos">66</span></a>        <span class="c1"># base_input_shapes = (start_shape,) + const_shapes + base_other_shapes</span>
</span><span id="Autoregressive-67"><a href="#Autoregressive-67"><span class="linenos">67</span></a>        <span class="n">base_output_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="o">*</span><span class="n">base_input_shapes</span><span class="p">)</span>
</span><span id="Autoregressive-68"><a href="#Autoregressive-68"><span class="linenos">68</span></a>        <span class="n">output_shape</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">,)</span> <span class="o">+</span> <span class="n">base_output_shape</span>
</span><span id="Autoregressive-69"><a href="#Autoregressive-69"><span class="linenos">69</span></a>        <span class="k">return</span> <span class="n">output_shape</span>
</span><span id="Autoregressive-70"><a href="#Autoregressive-70"><span class="linenos">70</span></a>
</span><span id="Autoregressive-71"><a href="#Autoregressive-71"><span class="linenos">71</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Autoregressive-72"><a href="#Autoregressive-72"><span class="linenos">72</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Autoregressive</span><span class="p">):</span>
</span><span id="Autoregressive-73"><a href="#Autoregressive-73"><span class="linenos">73</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Autoregressive-74"><a href="#Autoregressive-74"><span class="linenos">74</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">base_op</span>
</span><span id="Autoregressive-75"><a href="#Autoregressive-75"><span class="linenos">75</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">length</span>
</span><span id="Autoregressive-76"><a href="#Autoregressive-76"><span class="linenos">76</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">in_axes</span>
</span><span id="Autoregressive-77"><a href="#Autoregressive-77"><span class="linenos">77</span></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">where_self</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">where_self</span>
</span><span id="Autoregressive-78"><a href="#Autoregressive-78"><span class="linenos">78</span></a>            <span class="p">)</span>
</span><span id="Autoregressive-79"><a href="#Autoregressive-79"><span class="linenos">79</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Autoregressive-80"><a href="#Autoregressive-80"><span class="linenos">80</span></a>
</span><span id="Autoregressive-81"><a href="#Autoregressive-81"><span class="linenos">81</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Autoregressive-82"><a href="#Autoregressive-82"><span class="linenos">82</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">where_self</span><span class="p">))</span>
</span><span id="Autoregressive-83"><a href="#Autoregressive-83"><span class="linenos">83</span></a>
</span><span id="Autoregressive-84"><a href="#Autoregressive-84"><span class="linenos">84</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Autoregressive-85"><a href="#Autoregressive-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;autoregressive(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">where_self</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Autoregressive-86"><a href="#Autoregressive-86"><span class="linenos">86</span></a>
</span><span id="Autoregressive-87"><a href="#Autoregressive-87"><span class="linenos">87</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Autoregressive-88"><a href="#Autoregressive-88"><span class="linenos">88</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Autoregressive(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_op</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">where_self</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class for operators. An <code><a href="#Op">Op</a></code> represents a deterministic function or conditional
distribution.</p>

<p>Notes:</p>

<ul>
<li>An <code><a href="#Op">Op</a></code> <em>only</em> represents an operator—all functionality for sampling or density evaluation,
etc. is left to inference engines.</li>
<li><code><a href="#Op">Op</a></code>s must provide an <code>__eq__</code> method such that <em>mathematically equivalent</em> <code><a href="#Op">Op</a></code>s are
equal, regardless of if they occupy the same place in memory. For example, <code>d1 = Normal()</code>
and <code>d2 = Normal()</code> then <code>d1 == d2</code>. This base class provides a default implementation that
simply tests if the types are the same. If an Op takes parameters (e.g. <code><a href="#VMap">VMap</a></code>), this should be
overridden.</li>
<li><code><a href="#Op">Op</a></code>s are programmatically enforced to be frozen after initialization.</li>
</ul>
</div>


                            <div id="Autoregressive.__init__" class="classattr">
                                        <input id="Autoregressive.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Autoregressive</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_op</span><span class="p">:</span> <span class="n"><a href="#Op">Op</a></span>,</span><span class="param">	<span class="n">length</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">in_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>,</span><span class="param">	<span class="n">where_self</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span>)</span>

                <label class="view-source-button" for="Autoregressive.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Autoregressive.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Autoregressive.__init__-13"><a href="#Autoregressive.__init__-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Autoregressive.__init__-14"><a href="#Autoregressive.__init__-14"><span class="linenos">14</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Autoregressive.__init__-15"><a href="#Autoregressive.__init__-15"><span class="linenos">15</span></a>        <span class="n">base_op</span><span class="p">:</span> <span class="n">Op</span><span class="p">,</span>
</span><span id="Autoregressive.__init__-16"><a href="#Autoregressive.__init__-16"><span class="linenos">16</span></a>        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Autoregressive.__init__-17"><a href="#Autoregressive.__init__-17"><span class="linenos">17</span></a>        <span class="n">in_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
</span><span id="Autoregressive.__init__-18"><a href="#Autoregressive.__init__-18"><span class="linenos">18</span></a>        <span class="n">where_self</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Autoregressive.__init__-19"><a href="#Autoregressive.__init__-19"><span class="linenos">19</span></a>    <span class="p">):</span>
</span><span id="Autoregressive.__init__-20"><a href="#Autoregressive.__init__-20"><span class="linenos">20</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Autoregressive.__init__-21"><a href="#Autoregressive.__init__-21"><span class="linenos">21</span></a><span class="sd">        base_cond_dist - what distribution to repeat on</span>
</span><span id="Autoregressive.__init__-22"><a href="#Autoregressive.__init__-22"><span class="linenos">22</span></a><span class="sd">        num_constants - number of constant arguments (default 0)</span>
</span><span id="Autoregressive.__init__-23"><a href="#Autoregressive.__init__-23"><span class="linenos">23</span></a><span class="sd">        length - the number of times to repeat (optional if there are )</span>
</span><span id="Autoregressive.__init__-24"><a href="#Autoregressive.__init__-24"><span class="linenos">24</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Autoregressive.__init__-25"><a href="#Autoregressive.__init__-25"><span class="linenos">25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_op</span> <span class="o">=</span> <span class="n">base_op</span>
</span><span id="Autoregressive.__init__-26"><a href="#Autoregressive.__init__-26"><span class="linenos">26</span></a>        <span class="c1"># self.num_constants = num_constants</span>
</span><span id="Autoregressive.__init__-27"><a href="#Autoregressive.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
</span><span id="Autoregressive.__init__-28"><a href="#Autoregressive.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">in_axes</span><span class="p">)</span>
</span><span id="Autoregressive.__init__-29"><a href="#Autoregressive.__init__-29"><span class="linenos">29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">where_self</span> <span class="o">=</span> <span class="n">where_self</span>
</span><span id="Autoregressive.__init__-30"><a href="#Autoregressive.__init__-30"><span class="linenos">30</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Autoregressive(</span><span class="si">{</span><span class="n">base_op</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">base_op</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>base_cond_dist - what distribution to repeat on
num_constants - number of constant arguments (default 0)
length - the number of times to repeat (optional if there are )</p>
</div>


                            </div>
                            <div id="Autoregressive.base_op" class="classattr">
                                <div class="attr variable">
            <span class="name">base_op</span>

        
    </div>
    <a class="headerlink" href="#Autoregressive.base_op"></a>
    
    

                            </div>
                            <div id="Autoregressive.length" class="classattr">
                                <div class="attr variable">
            <span class="name">length</span>

        
    </div>
    <a class="headerlink" href="#Autoregressive.length"></a>
    
    

                            </div>
                            <div id="Autoregressive.in_axes" class="classattr">
                                <div class="attr variable">
            <span class="name">in_axes</span>

        
    </div>
    <a class="headerlink" href="#Autoregressive.in_axes"></a>
    
    

                            </div>
                            <div id="Autoregressive.where_self" class="classattr">
                                <div class="attr variable">
            <span class="name">where_self</span>

        
    </div>
    <a class="headerlink" href="#Autoregressive.where_self"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Op">Op</a></dt>
                                <dd id="Autoregressive.name" class="variable"><a href="#Op.name">name</a></dd>
                <dd id="Autoregressive.random" class="variable"><a href="#Op.random">random</a></dd>
                <dd id="Autoregressive.get_shape" class="function"><a href="#Op.get_shape">get_shape</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>